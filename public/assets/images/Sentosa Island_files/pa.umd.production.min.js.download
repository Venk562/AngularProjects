(function(l){typeof define=="function"&&define.amd?define(l):l()})(function(){"use strict";var gs=Object.defineProperty,ms=Object.defineProperties;var _s=Object.getOwnPropertyDescriptors;var Rt=Object.getOwnPropertySymbols;var ys=Object.prototype.hasOwnProperty,Es=Object.prototype.propertyIsEnumerable;var xt=(l,w,m)=>w in l?gs(l,w,{enumerable:!0,configurable:!0,writable:!0,value:m}):l[w]=m,_=(l,w)=>{for(var m in w||(w={}))ys.call(w,m)&&xt(l,m,w[m]);if(Rt)for(var m of Rt(w))Es.call(w,m)&&xt(l,m,w[m]);return l},C=(l,w)=>ms(l,_s(w));var T=(l,w,m)=>new Promise((D,B)=>{var de=R=>{try{k(m.next(R))}catch(P){B(P)}},j=R=>{try{k(m.throw(R))}catch(P){B(P)}},k=R=>R.done?D(R.value):Promise.resolve(R.value).then(de,j);k((m=m.apply(l,w)).next())});const l={VIATOR:"viator",MUSEMENT:"musement",KLOOK:"klook",CIVITATIS:"civitatis",TICKETBAR:"ticketbar",TIQETS:"tiqets",MEDIAVINE:"mediavine"},w=[/wp-admin/,/wp-login/,/preview=/,/localhost/,/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/,/file:\/\//,/content:\/\//,/getyourguide/,/gygdev\.gygtest/,/translate\.google(usercontent)?\.com/],m="https://collector.getyourguide.com",D="https://widget.getyourguide.com",B="gyg_visitor_id";function de(t){let e=0;return w.forEach(r=>{r.test(t)&&e++}),e===0}function j(t,e,r){const n=new RegExp("([?&])"+t+"=.*?(&|$)","i"),s=r.indexOf("?")!==-1?"&":"?";return r.match(n)?r.replace(n,"$1"+t+"="+e+"$2"):r+s+t+"="+e}function k(t){const e="deeplink_id=[\\w-]+";return t.replace(new RegExp(`${e}&|&${e}|${e}`),"")}function R(t,e){const r=document.getElementsByTagName("head")[0],n=document.createElement("script");n.async=!0,n.src=t,r.appendChild(n)}class P{}const St=(t,e,...r)=>{t&&console.info(`%c[PA][${e}]`,"color: orange; font-weight: bold;",...r)};class v extends P{constructor(e,r,n){super(),this.name=e,this.debug=n,this.querySelector=r}scrape(e){return Array.from(e.querySelectorAll(this.querySelector)).filter(n=>!n.getAttribute("data-gyg-scraped"))}markElements(e){e.forEach(r=>{r.setAttribute("data-gyg-scraped",Date.now().toString())})}highlightElements(e){this.debug&&e.forEach(r=>{r.style.border="10px solid #39ff14"})}start(n){return T(this,arguments,function*({document:e,payload:r}){const s=this.scrape(e);return this.markElements(s),this.highlightElements(s),this.processElements(s,r),St(this.debug,this.name,this.querySelector,`items found: ${s.length}`,s),r})}}let Y;const Ut=new Uint8Array(16);function Ot(){if(!Y&&(Y=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Y))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Y(Ut)}const Ct=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Lt(t){return typeof t=="string"&&Ct.test(t)}const y=[];for(let t=0;t<256;++t)y.push((t+256).toString(16).slice(1));function Ze(t,e=0){return y[t[e+0]]+y[t[e+1]]+y[t[e+2]]+y[t[e+3]]+"-"+y[t[e+4]]+y[t[e+5]]+"-"+y[t[e+6]]+y[t[e+7]]+"-"+y[t[e+8]]+y[t[e+9]]+"-"+y[t[e+10]]+y[t[e+11]]+y[t[e+12]]+y[t[e+13]]+y[t[e+14]]+y[t[e+15]]}function Gt(t){if(!Lt(t))throw TypeError("Invalid UUID");let e;const r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}function Nt(t){t=unescape(encodeURIComponent(t));const e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}const Dt="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Bt="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function jt(t,e,r){function n(s,o,a,u){var d;if(typeof s=="string"&&(s=Nt(s)),typeof o=="string"&&(o=Gt(o)),((d=o)===null||d===void 0?void 0:d.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+s.length);if(c.set(o),c.set(s,o.length),c=r(c),c[6]=c[6]&15|e,c[8]=c[8]&63|128,a){u=u||0;for(let i=0;i<16;++i)a[u+i]=c[i];return a}return Ze(c)}try{n.name=t}catch(s){}return n.DNS=Dt,n.URL=Bt,n}const et={randomUUID:typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function ue(t,e,r){if(et.randomUUID&&!e&&!t)return et.randomUUID();t=t||{};const n=t.random||(t.rng||Ot)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Ze(n)}function kt(t,e,r,n){switch(t){case 0:return e&r^~e&n;case 1:return e^r^n;case 2:return e&r^e&n^r&n;case 3:return e^r^n}}function le(t,e){return t<<e|t>>>32-e}function Mt(t){const e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){const a=unescape(encodeURIComponent(t));t=[];for(let u=0;u<a.length;++u)t.push(a.charCodeAt(u))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);const n=t.length/4+2,s=Math.ceil(n/16),o=new Array(s);for(let a=0;a<s;++a){const u=new Uint32Array(16);for(let d=0;d<16;++d)u[d]=t[a*64+d*4]<<24|t[a*64+d*4+1]<<16|t[a*64+d*4+2]<<8|t[a*64+d*4+3];o[a]=u}o[s-1][14]=(t.length-1)*8/Math.pow(2,32),o[s-1][14]=Math.floor(o[s-1][14]),o[s-1][15]=(t.length-1)*8&4294967295;for(let a=0;a<s;++a){const u=new Uint32Array(80);for(let f=0;f<16;++f)u[f]=o[a][f];for(let f=16;f<80;++f)u[f]=le(u[f-3]^u[f-8]^u[f-14]^u[f-16],1);let d=r[0],c=r[1],i=r[2],h=r[3],p=r[4];for(let f=0;f<80;++f){const ce=Math.floor(f/20),ze=le(d,5)+kt(ce,c,i,h)+p+e[ce]+u[f]>>>0;p=h,h=i,i=le(c,30)>>>0,c=d,d=ze}r[0]=r[0]+d>>>0,r[1]=r[1]+c>>>0,r[2]=r[2]+i>>>0,r[3]=r[3]+h>>>0,r[4]=r[4]+p>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}const F=jt("v5",80,Mt);function K(t,e){try{e&&localStorage.setItem(t,e),window._GYG.localStorage=C(_({},window._GYG.localStorage),{[t]:e})}catch(r){window._GYG.localStorage=C(_({},window._GYG.localStorage),{[t]:e})}}function tt(t){try{if(localStorage.getItem(t))return localStorage.getItem(t)}catch(e){if(window._GYG.localStorage)return window._GYG.localStorage[t]}return null}function Vt(t){try{localStorage.removeItem(t)}catch(e){window._GYG.localStorage&&delete window._GYG.localStorage[t]}}const $t="6ba7b811-9dad-11d1-80b4-00c04fd430c8",fe=t=>{try{const e=new URL(t),r=(e.hostname+e.pathname).replace(/^www\./,"").replace(/\/$/,"");return F(r,$t)}catch(e){return}},N=class N extends v{constructor(){super("GYG-Deeplinks",N.GYG_LINK_QUERY,window._GYG.debug)}getBoundingClientRect(e){const{width:r,height:n,x:s,y:o}=e.getBoundingClientRect();return{x:s!==void 0?Math.round(s):void 0,y:o!==void 0?Math.round(o):void 0,width:r!==void 0?Math.round(r):void 0,height:n!==void 0?Math.round(n):void 0}}cleanUrl(e){var n;const r=e;if(r&&r.searchParams.has("cmp")){const s=(n=r.searchParams.get("cmp"))==null?void 0:n.split("_amcid")[0];s&&r.searchParams.set("cmp",s)}return r&&r.searchParams.has("recommended_activities")&&r.searchParams.delete("recommended_activities"),r.toString()}isDirectGYGLink(e){const r=e.getAttribute("href")||"";return/^https?:\/\/(www\.)?getyourguide/.test(r)}processElements(e,r){e.filter(this.isDirectGYGLink).filter(n=>n.closest("[data-gyg-widget]")===null).forEach(n=>{var f;const s=this.getBoundingClientRect(n),o=n.getAttribute("href")||"",a=new URL(o),u=a.searchParams.get("partner_id");let d;u?K("partner_id",u):r.header.partner_hash_code&&(a.searchParams.set("partner_id",r.header.partner_hash_code),d=r.header.partner_hash_code);const c=this.cleanUrl(a),i=F(c,N.NAMESPACE),h=fe(r.header.url),p=C(_({},s),{url:c,text:(f=n.textContent)==null?void 0:f.trim(),deeplink_id:i,page_id:h});this.attachIds(n,i,h,d),r.deeplinks=r.deeplinks||[],r.deeplinks.push(p)})}attachIds(e,r,n,s){let o=e.getAttribute("href")||"";o&&(this.isFixTrackDefined()||(o=j("deeplink_id",r,o),n&&(o=j("page_id",n,o)),s&&(o=j("partner_id",s,o))),e.setAttribute("href",o.toString()))}isFixTrackDefined(){return window.hasOwnProperty("FIX")&&window.FIX.hasOwnProperty("track")}};N.GYG_LINK_QUERY='a[href*="getyourguide."]',N.NAMESPACE="6ba7b811-9dad-11d1-80b4-00c04fd430c8";let he=N;const W=class W extends v{constructor(){super("VIATOR-Deeplinks",W.VIATOR_LINK_QUERY,window._GYG.debug)}processElements(e,r){return e.forEach(n=>{var o;const s={name:l.VIATOR,url:n.getAttribute("href"),text:(o=n.textContent)==null?void 0:o.trim()};r.competitor_deeplinks=r.competitor_deeplinks||[],r.competitor_deeplinks.push(s)}),r}};W.VIATOR_LINK_QUERY='a[href*="www.partner.viator.com"]';let pe=W;const Q=class Q extends v{constructor(){super("TICKETBAR-Deeplinks",Q.TICKETBAR_LINK_QUERY,window._GYG.debug)}processElements(e,r){return e.forEach(n=>{var o;const s={name:l.TICKETBAR,url:n.getAttribute("href"),text:(o=n.textContent)==null?void 0:o.trim()};r.competitor_deeplinks=r.competitor_deeplinks||[],r.competitor_deeplinks.push(s)}),r}};Q.TICKETBAR_LINK_QUERY='a[href*="ticketbar.eu"]';let ge=Q;const H=class H extends v{constructor(){super("MUSEMENT-Deeplinks",H.MUSEMENT_LINK_QUERY,window._GYG.debug)}processElements(e,r){return e.forEach(n=>{var o;const s={name:l.MUSEMENT,url:n.getAttribute("href"),text:(o=n.textContent)==null?void 0:o.trim()};r.competitor_deeplinks=r.competitor_deeplinks||[],r.competitor_deeplinks.push(s)}),r}};H.MUSEMENT_LINK_QUERY='a[href*="www.musement.com"]';let me=H;const J=class J extends v{constructor(){super("CIVITATIS-Deeplinks",J.CIVITATIS_LINK_QUERY,window._GYG.debug)}processElements(e,r){e.forEach(n=>{var o;const s={name:l.CIVITATIS,url:n.getAttribute("href"),text:(o=n.textContent)==null?void 0:o.trim()};r.competitor_deeplinks=r.competitor_deeplinks||[],r.competitor_deeplinks.push(s)})}};J.CIVITATIS_LINK_QUERY='a[href*="www.civitatis.com"]';let _e=J;const z=class z extends v{constructor(){super("TIQETS-Deeplinks",z.TIQETS_LINK_QUERY,window._GYG.debug)}processElements(e,r){return e.forEach(n=>{var o;const s={name:l.TIQETS,url:n.getAttribute("href"),text:(o=n.textContent)==null?void 0:o.trim()};r.competitor_deeplinks=r.competitor_deeplinks||[],r.competitor_deeplinks.push(s)}),r}};z.TIQETS_LINK_QUERY='a[href*="www.tiqets.com"]';let ye=z;const X=class X extends v{constructor(){super("KLOOK-Deeplinks",X.KLOOK_LINK_QUERY,window._GYG.debug)}processElements(e,r){return e.forEach(n=>{var o;const s={name:l.KLOOK,url:n.getAttribute("href"),text:(o=n.textContent)==null?void 0:o.trim()};r.competitor_deeplinks=r.competitor_deeplinks||[],r.competitor_deeplinks.push(s)}),r}};X.KLOOK_LINK_QUERY='a[href*="www.klook.com"]';let Ee=X;const Yt=[he,pe,ge,me,_e,ye,Ee],Ft="0e7c8e4a-453a-4a3f-aa76-186f61d75001",Kt=t=>{const e=new URL(t),r=e.pathname.replace(/\/$/,"").split("/").pop().split(".");let n=r[0];n==="activites"&&(n="activities"),n!=="activities"&&n!=="city"&&n!=="availability"&&n!=="activities-auto"&&n!=="map"&&(n="custom");let s=r[1];s==="jpg"&&(s="jpeg");const o={p:e.searchParams.has("partner_id")?e.searchParams.get("partner_id"):e.pathname.split("/")[1],w:n,f:s,m:e.searchParams.has("cmp")?e.searchParams.get("cmp"):void 0,q:e.searchParams.has("q")?e.searchParams.get("q"):void 0,i:e.searchParams.has("iata")?e.searchParams.get("iata"):void 0,d:e.searchParams.has("location_id")?e.searchParams.get("location_id"):void 0,c:e.searchParams.has("currency")?e.searchParams.get("currency"):void 0,l:e.searchParams.has("locale_code")?e.searchParams.get("locale_code"):void 0,n:e.searchParams.has("number_of_items")?Number(e.searchParams.get("number_of_items")):void 0,t:e.searchParams.has("tour_ids")?e.searchParams.get("tour_ids"):void 0,u:e.searchParams.has("tour_id")?e.searchParams.get("tour_id"):void 0,h:e.searchParams.has("theme")?e.searchParams.get("theme"):void 0,v:e.searchParams.has("variant")?e.searchParams.get("variant"):void 0,e:e.searchParams.has("excluded_tour_ids")?e.searchParams.get("excluded_tour_ids"):void 0,a:e.searchParams.has("lat")?e.searchParams.get("lat"):void 0,o:e.searchParams.has("lon")?e.searchParams.get("lon"):void 0};return F(JSON.stringify(o),Ft)},qt="data-gyg-widget-created",Wt="data-gyg-widget-rendered",Qt="data-gyg-widget-ttfb",Ht="data-gyg-widget-fcp",rt="data-gyg-widget-lcp",Z=class Z extends v{constructor(){super("GYG-Widget",Z.GYG_WIDGET_QUERY,window._GYG.debug)}extractIds(e){return e?e.split(",").map(n=>parseInt(n)).filter(n=>!Number.isNaN(n)):null}parseNumber(e){return e?parseInt(e):null}parseFloat(e){return e?parseFloat(e):null}getBoundingClientRect(e){const{width:r,height:n,x:s,y:o}=e.getBoundingClientRect();return{x:s!==void 0?Math.round(s):0,y:o!==void 0?Math.round(o):0,width:r!==void 0?Math.round(r):0,height:n!==void 0?Math.round(n):0}}getWidgetType(e){let r=e.pathname.split("/")[2].split(".")[0];return r==="activites"&&(r="activities"),r!=="activities"&&r!=="city"&&r!=="availability"&&r!=="activities-auto"&&r!=="map"&&(r="custom"),r}getWidgetFormat(e){const r=e.pathname.split("/")[2].split(".");let n="frame";return r.length>1&&(n=r[1],n==="jpg"&&(n="jpeg")),n}getWidgetRenderingTime(e){const r=e.parentElement;if(!r)return;const n=e.getAttribute(Wt),s=r.getAttribute(qt);if(!(!n||!s))return parseInt(n,10)-parseInt(s,10)}getWidgetFcp(e){const r=e.getAttribute(Ht);return r?this.parseFloat(r):null}getWidgetTtfb(e){const r=e.getAttribute(Qt);return r?this.parseFloat(r):null}getWidgetLcp(e){const r=e.getAttribute(rt);return r?this.parseFloat(r):null}processElements(e,r){return e.forEach(n=>{const s=this.getBoundingClientRect(n),o=n.getAttribute("src");if(!o)return;const a=new URL(o),u=a.searchParams.get("partner_id"),d=this.parseFloat(a.searchParams.get("lat")),c=this.parseFloat(a.searchParams.get("lon")),i=C(_({},s),{type:this.getWidgetType(a),rendering_time:this.getWidgetRenderingTime(n),fcp:this.getWidgetFcp(n),ttfb:this.getWidgetTtfb(n),lcp:this.getWidgetLcp(n),widget_parameters:{campaign:a.searchParams.get("cmp"),currency:a.searchParams.get("currency"),excluded_tour_ids:this.extractIds(a.searchParams.get("excluded_tour_ids")),iata:a.searchParams.get("iata"),locale_code:a.searchParams.get("locale_code"),number_of_items:this.parseNumber(a.searchParams.get("number_of_items")),partner_hash_code:u,query:a.searchParams.get("q"),tour_ids:this.getTourIdsFromSearchParams(a.searchParams),widget_id:Kt(o),geo_location:typeof d=="number"&&typeof c=="number"?{latitude:d,longitude:c}:null,format:this.getWidgetFormat(a)}});u&&K("partner_id",u),r.widgets=r.widgets||[],r.widgets.push(i)}),r}getTourIdsFromSearchParams(e){const r=this.extractIds(e.get("tour_ids"));if(!r){const n=this.parseNumber(e.get("tour_id"));return n?[n]:null}return r}};Z.GYG_WIDGET_QUERY=`iframe[src^="https://widget.getyourguide.com"][${rt}]`;let we=Z;const ee=class ee extends v{constructor(){super("CIVITATIS-CompetitorWidgets",ee.CIVITATIS_LINK_QUERY,window._GYG.debug)}processElements(e,r){e.forEach(n=>{const s={name:l.CIVITATIS,url:n.getAttribute("src")};r.competitor_widgets=r.competitor_widgets||[],r.competitor_widgets.push(s)})}};ee.CIVITATIS_LINK_QUERY='iframe[src*="www.civitatis.com"]';let be=ee;const te=class te extends v{constructor(){super("KLOOK-CompetitorWidgets",te.KLOOK_LINK_QUERY,window._GYG.debug)}processElements(e,r){return e.forEach(n=>{const s={name:l.KLOOK,url:n.getAttribute("src")};r.competitor_widgets=r.competitor_widgets||[],r.competitor_widgets.push(s)}),r}};te.KLOOK_LINK_QUERY='iframe[src*="affiliate.klook.com"]';let ve=te;const re=class re extends v{constructor(){super("Ticketbar-CompetitorWidgets",re.TICKETBAR_WIDGET,window._GYG.debug)}processElements(e,r){return e.forEach(()=>{const n={name:l.TICKETBAR,url:""};r.competitor_widgets=r.competitor_widgets||[],r.competitor_widgets.push(n)}),r}};re.TICKETBAR_WIDGET='div[class*="Ticketbar-Widget"]';let Ie=re;const ne=class ne extends v{constructor(){super("Tiqets-CompetitorWidgets",ne.TIQETS_WIDGET,window._GYG.debug)}processElements(e,r){return e.forEach(n=>{const s={name:l.TIQETS,url:n.getAttribute("src")};r.competitor_widgets=r.competitor_widgets||[],r.competitor_widgets.push(s)}),r}};ne.TIQETS_WIDGET='iframe[src*="www.tiqets.com/widgets"]';let Te=ne;const se=class se extends v{constructor(){super("Viator-CompetitorWidgets",se.VIATOR_WIDGET,window._GYG.debug)}processElements(e,r){return e.forEach(n=>{const s={name:l.VIATOR,url:n.getAttribute("src")};r.competitor_widgets=r.competitor_widgets||[],r.competitor_widgets.push(s)}),r}};se.VIATOR_WIDGET='iframe[src*="www.viator.com/orion/widget"]';let Pe=se;const oe=class oe extends v{constructor(){super("Mediavine-CompetitorWidgets",oe.MEDIAVINE_WIDGET,window._GYG.debug)}processElements(e,r){return e.forEach(n=>{const s=n.getAttribute("data-slotid"),o=`${document.baseURI}#slot=${s}`,a={name:l.MEDIAVINE,url:o};r.competitor_widgets=r.competitor_widgets||[],r.competitor_widgets.push(a)}),r}};oe.MEDIAVINE_WIDGET='div[class*="mv-ad-box"]';let Ae=oe;const Jt=[we,be,ve,Ie,Te,Pe,Ae],zt=[...Yt,...Jt];class Xt extends P{start(r){return T(this,arguments,function*({payload:e}){const{offsetWidth:n,scrollHeight:s}=document.body,{fontFamily:o,fontSize:a,lineHeight:u}=window.getComputedStyle(document.body),{navigationStart:d,unloadEventStart:c,unloadEventEnd:i,redirectStart:h,redirectEnd:p,fetchStart:f,domainLookupStart:ce,domainLookupEnd:ze,connectStart:ns,connectEnd:ss,secureConnectionStart:Xe,requestStart:os,responseStart:is,responseEnd:as,domLoading:cs,domInteractive:ds,domContentLoadedEventStart:us,domContentLoadedEventEnd:ls,domComplete:fs,loadEventStart:hs,loadEventEnd:ps}=performance.timing;return e.page={width:n,height:s,page_title:document.title,page_font_family:o,page_font_size:a,page_line_height:u,performance:{navigation_start:d,unload_event_start:c,unload_event_end:i,redirect_start:h,redirect_end:p,fetch_start:f,domain_lookup_start:ce,domain_lookup_end:ze,connect_start:ns,connect_end:ss,secure_connection_start:Xe!=null?Xe:0,request_start:os,response_start:is,response_end:as,dom_loading:cs,dom_interactive:ds,dom_content_loaded_event_start:us,dom_content_loaded_event_end:ls,dom_complete:fs,load_event_start:hs,load_event_end:ps}},e})}}class Zt extends P{getOS(){let e="Unknown OS";return navigator.appVersion.indexOf("Win")!==-1&&(e="Windows"),navigator.appVersion.indexOf("Mac")!==-1&&(e="MacOS"),navigator.appVersion.indexOf("X11")!==-1&&(e="UNIX"),navigator.appVersion.indexOf("Linux")!==-1&&(e="Linux"),e}getPartnerHashCode(){let e=null;const r=document.querySelector('script[src*="getyourguide.com/dist/pa."]');return r&&(e=r.getAttribute("data-gyg-partner-id"),e&&K("partner_id",e)),e||(e=tt("partner_id")),e==null?void 0:e.toUpperCase()}isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}getPlatform(){return this.isMobileDevice()?"mweb":"desktop"}start(r){return T(this,arguments,function*({payload:e}){const{userAgent:n=null,language:s=null}=navigator,{referrer:o=null}=document,{href:a=null,origin:u=null}=window.location;return e.header={platform:this.getPlatform(),domain:u,url:a,user_agent:n,referrer_domain:o,os:this.getOS(),partner_hash_code:this.getPartnerHashCode(),accept_language:[s]},e})}}function L(t,e){if(!e)return"";let r="; "+t;return e===!0?r:r+"="+e}function er(t){if(typeof t.expires=="number"){const e=Math.min(Date.now()+t.expires*864e5,864e13);t.expires=new Date(e)}return L("Expires",t.expires?t.expires.toUTCString():"")+L("Domain",t.domain)+L("Path",t.path)+L("Secure",t.secure)+L("Partitioned",t.partitioned)+L("SameSite",t.sameSite)}function tr(t,e,r){return encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)+er(r)}function rr(t){let e={};const r=t?t.split("; "):[];for(let n of r){const s=n.split("=");let o=s.slice(1).join("=");o[0]==='"'&&(o=o.slice(1,-1));try{const a=decodeURIComponent(s[0]);e[a]=o.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)}catch(a){}}return e}function nr(){return rr(document.cookie)}function sr(t){return nr()[t]}function or(t,e,r){document.cookie=tr(t,e,_({path:"/"},r))}var b=typeof globalThis!="undefined"&&globalThis||typeof self!="undefined"&&self||typeof b!="undefined"&&b,I={searchParams:"URLSearchParams"in b,iterable:"Symbol"in b&&"iterator"in Symbol,blob:"FileReader"in b&&"Blob"in b&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in b,arrayBuffer:"ArrayBuffer"in b};function ir(t){return t&&DataView.prototype.isPrototypeOf(t)}if(I.arrayBuffer)var ar=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],cr=ArrayBuffer.isView||function(t){return t&&ar.indexOf(Object.prototype.toString.call(t))>-1};function M(t){if(typeof t!="string"&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||t==="")throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function Re(t){return typeof t!="string"&&(t=String(t)),t}function xe(t){var e={next:function(){var r=t.shift();return{done:r===void 0,value:r}}};return I.iterable&&(e[Symbol.iterator]=function(){return e}),e}function g(t){this.map={},t instanceof g?t.forEach(function(e,r){this.append(r,e)},this):Array.isArray(t)?t.forEach(function(e){this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}g.prototype.append=function(t,e){t=M(t),e=Re(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},g.prototype.delete=function(t){delete this.map[M(t)]},g.prototype.get=function(t){return t=M(t),this.has(t)?this.map[t]:null},g.prototype.has=function(t){return this.map.hasOwnProperty(M(t))},g.prototype.set=function(t,e){this.map[M(t)]=Re(e)},g.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},g.prototype.keys=function(){var t=[];return this.forEach(function(e,r){t.push(r)}),xe(t)},g.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),xe(t)},g.prototype.entries=function(){var t=[];return this.forEach(function(e,r){t.push([r,e])}),xe(t)},I.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function Se(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function nt(t){return new Promise(function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}})}function dr(t){var e=new FileReader,r=nt(e);return e.readAsArrayBuffer(t),r}function ur(t){var e=new FileReader,r=nt(e);return e.readAsText(t),r}function lr(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}function st(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function ot(){return this.bodyUsed=!1,this._initBody=function(t){this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?typeof t=="string"?this._bodyText=t:I.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:I.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:I.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():I.arrayBuffer&&I.blob&&ir(t)?(this._bodyArrayBuffer=st(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):I.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||cr(t))?this._bodyArrayBuffer=st(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||(typeof t=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):I.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},I.blob&&(this.blob=function(){var t=Se(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=Se(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else return this.blob().then(dr)}),this.text=function(){var t=Se(this);if(t)return t;if(this._bodyBlob)return ur(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(lr(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},I.formData&&(this.formData=function(){return this.text().then(pr)}),this.json=function(){return this.text().then(JSON.parse)},this}var fr=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function hr(t){var e=t.toUpperCase();return fr.indexOf(e)>-1?e:t}function U(t,e){if(!(this instanceof U))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{};var r=e.body;if(t instanceof U){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new g(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,!r&&t._bodyInit!=null&&(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new g(e.headers)),this.method=hr(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),(this.method==="GET"||this.method==="HEAD")&&(e.cache==="no-store"||e.cache==="no-cache")){var n=/([?&])_=[^&]*/;if(n.test(this.url))this.url=this.url.replace(n,"$1_="+new Date().getTime());else{var s=/\?/;this.url+=(s.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}U.prototype.clone=function(){return new U(this,{body:this._bodyInit})};function pr(t){var e=new FormData;return t.trim().split("&").forEach(function(r){if(r){var n=r.split("="),s=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(s),decodeURIComponent(o))}}),e}function gr(t){var e=new g,r=t.replace(/\r?\n[\t ]+/g," ");return r.split("\r").map(function(n){return n.indexOf(`
`)===0?n.substr(1,n.length):n}).forEach(function(n){var s=n.split(":"),o=s.shift().trim();if(o){var a=s.join(":").trim();e.append(o,a)}}),e}ot.call(U.prototype);function A(t,e){if(!(this instanceof A))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText===void 0?"":""+e.statusText,this.headers=new g(e.headers),this.url=e.url||"",this._initBody(t)}ot.call(A.prototype),A.prototype.clone=function(){return new A(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},A.error=function(){var t=new A(null,{status:0,statusText:""});return t.type="error",t};var mr=[301,302,303,307,308];A.redirect=function(t,e){if(mr.indexOf(e)===-1)throw new RangeError("Invalid status code");return new A(null,{status:e,headers:{location:t}})};var O=b.DOMException;try{new O}catch(t){O=function(e,r){this.message=e,this.name=r;var n=Error(e);this.stack=n.stack},O.prototype=Object.create(Error.prototype),O.prototype.constructor=O}function it(t,e){return new Promise(function(r,n){var s=new U(t,e);if(s.signal&&s.signal.aborted)return n(new O("Aborted","AbortError"));var o=new XMLHttpRequest;function a(){o.abort()}o.onload=function(){var d={status:o.status,statusText:o.statusText,headers:gr(o.getAllResponseHeaders()||"")};d.url="responseURL"in o?o.responseURL:d.headers.get("X-Request-URL");var c="response"in o?o.response:o.responseText;setTimeout(function(){r(new A(c,d))},0)},o.onerror=function(){setTimeout(function(){n(new TypeError("Network request failed"))},0)},o.ontimeout=function(){setTimeout(function(){n(new TypeError("Network request failed"))},0)},o.onabort=function(){setTimeout(function(){n(new O("Aborted","AbortError"))},0)};function u(d){try{return d===""&&b.location.href?b.location.href:d}catch(c){return d}}o.open(s.method,u(s.url),!0),s.credentials==="include"?o.withCredentials=!0:s.credentials==="omit"&&(o.withCredentials=!1),"responseType"in o&&(I.blob?o.responseType="blob":I.arrayBuffer&&s.headers.get("Content-Type")&&s.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(o.responseType="arraybuffer")),e&&typeof e.headers=="object"&&!(e.headers instanceof g)?Object.getOwnPropertyNames(e.headers).forEach(function(d){o.setRequestHeader(d,Re(e.headers[d]))}):s.headers.forEach(function(d,c){o.setRequestHeader(c,d)}),s.signal&&(s.signal.addEventListener("abort",a),o.onreadystatechange=function(){o.readyState===4&&s.signal.removeEventListener("abort",a)}),o.send(typeof s._bodyInit=="undefined"?null:s._bodyInit)})}it.polyfill=!0,b.fetch||(b.fetch=it,b.Headers=g,b.Request=U,b.Response=A);const _r=t=>(Object.prototype.hasOwnProperty.call(t,"GYG")||(t.GYG=t.GYG||{}),t.GYG.visitorIdPromise||(t.GYG.visitorIdPromise=fetch(`${D}/gnikcart`,{credentials:"include"}).then(e=>e.json()).catch(()=>{const e=ue().replace(/-/g,"").toUpperCase().substring(0,32);t.GYG.visitorIdPromise=Promise.resolve({visitor_id:e})})),t.GYG.visitorIdPromise);class yr extends P{getVisitorId(){return T(this,null,function*(){let e=sessionStorage.getItem(B)||"";if(!e){const{visitor_id:r}=yield _r(window);r&&sessionStorage.setItem(B,r),e=r}return e})}getSessionId(e){return e=e||sr("session_id"),e||(e=ue(),or("session_id",e)),e}start(n){return T(this,arguments,function*({sessionId:e,payload:r}){const{language:s=null}=navigator;return r.user={visitor_id:yield this.getVisitorId(),session_id:this.getSessionId(e),locale_code:s},r})}}const ie=class ie extends P{start(r){return T(this,arguments,function*({payload:e}){return e.event_properties={uuid:ue(),sent_by:ie.SENT_BY},e})}};ie.SENT_BY="PartnerAnalyzer";let Ue=ie;class Er extends P{isScriptLoadedViaWidget(e){return e.dataset.gygScriptOrigin==="widget"}getScriptOriginType(e){const r=e.some(this.isScriptLoadedViaWidget),n=!e.every(this.isScriptLoadedViaWidget);return r&&n?"BOTH":r?"WIDGET":"DIRECT"}getScripts(){const e=window._GYG.env==="production"?`${D}/dist/pa.umd.production.min.js`:"dist/pa.umd.development.js";return Array.from(document.querySelectorAll(`script[src*="${e}"]`))}start(r){return T(this,arguments,function*({payload:e}){const n=this.getScriptOriginType(this.getScripts());return e.script_origin=n,e})}}const wr=[...[Ue,yr,Zt,Xt,Er],...zt];function at(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ct={exports:{}};(function(t){(function(){function e(c,i,h){var p;document.createEvent?(p=document.createEvent("HTMLEvents"),p.initEvent(i,!0,!0)):document.createEventObject&&(p=document.createEventObject(),p.eventType=i),p.state=h,p.eventName=i,c.dispatchEvent?c.dispatchEvent(p):c.fireEvent&&htmlEvents["on"+i]?c.fireEvent("on"+p.eventType,p):c[i]?c[i]():c["on"+i]&&c["on"+i]()}function r(c,i,h){c.addEventListener?c.addEventListener(i,h,!1):c.attachEvent&&htmlEvents["on"+i]?c.attachEvent("on"+i,h):c["on"+i]=h}function n(c,i,h){c.removeventListener?c.removeEventListener(i,h,!1):c.detachEvent&&htmlEvents["on"+i]?c.detachEvent("on"+i,h):c["on"+i]=null}function s(){return typeof window!="undefined"&&window.history&&"pushState"in window.history}if(s()){var o=window.history,a=o.pushState;o.pushState=function(c){var i=a.apply(o,arguments);return e(window,"pushstate",c),e(window,"changestate",c),i};var u=o.replaceState;o.replaceState=function(c){var i=u.apply(o,arguments);return e(window,"replacestate",c),e(window,"changestate",c),i},r(window,"popstate",function(c){e(window,"changestate",c.state)})}var d={isHistorySupported:s,addEventListener:r,removeEventListener:n,triggerEvent:e};s()&&(window.HistoryEvents=d),t.exports=d})()})(ct);var br=ct.exports;const vr=at(br),Ir=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Tr=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Pr=/^\s*["[{]|^\s*-?\d[\d.]{0,14}\s*$/;function Ar(t,e){if(t!=="__proto__"&&!(t==="constructor"&&e&&typeof e=="object"&&"prototype"in e))return e}function Rr(t,e={}){if(typeof t!="string")return t;const r=t.toLowerCase().trim();if(r==="true")return!0;if(r==="false")return!1;if(r==="null")return null;if(r==="nan")return Number.NaN;if(r==="infinity")return Number.POSITIVE_INFINITY;if(r!=="undefined"){if(!Pr.test(t)){if(e.strict)throw new SyntaxError("Invalid JSON");return t}try{return Ir.test(t)||Tr.test(t)?JSON.parse(t,Ar):JSON.parse(t)}catch(n){if(e.strict)throw n;return t}}}const xr=/#/g,Sr=/&/g,Ur=/=/g,dt=/\+/g,Or=/%5B/gi,Cr=/%5D/gi,Lr=/%5E/gi,Gr=/%60/gi,Nr=/%7B/gi,Dr=/%7C/gi,Br=/%7D/gi,jr=/%20/gi;function kr(t){return encodeURI(""+t).replace(Dr,"|").replace(Or,"[").replace(Cr,"]")}function Oe(t){return kr(t).replace(dt,"%2B").replace(jr,"+").replace(xr,"%23").replace(Sr,"%26").replace(Gr,"`").replace(Nr,"{").replace(Br,"}").replace(Lr,"^")}function Ce(t){return Oe(t).replace(Ur,"%3D")}function ut(t=""){try{return decodeURIComponent(""+t)}catch(e){return""+t}}function Mr(t){return ut(t.replace(dt," "))}function Vr(t=""){const e={};t[0]==="?"&&(t=t.substr(1));for(const r of t.split("&")){const n=r.match(/([^=]+)=?(.*)/)||[];if(n.length<2)continue;const s=ut(n[1]);if(s==="__proto__"||s==="constructor")continue;const o=Mr(n[2]||"");e[s]?Array.isArray(e[s])?e[s].push(o):e[s]=[e[s],o]:e[s]=o}return e}function $r(t,e){return(typeof e=="number"||typeof e=="boolean")&&(e=String(e)),e?Array.isArray(e)?e.map(r=>`${Ce(t)}=${Oe(r)}`).join("&"):`${Ce(t)}=${Oe(e)}`:Ce(t)}function Yr(t){return Object.keys(t).map(e=>$r(e,t[e])).join("&")}const Fr=/^\w+:(\/\/)?/,Kr=/^\/\/[^/]+/;function lt(t,e=!1){return Fr.test(t)||e&&Kr.test(t)}const qr=/\/$|\/\?/;function Le(t="",e=!1){return e?qr.test(t):t.endsWith("/")}function Wr(t="",e=!1){if(!e)return(Le(t)?t.slice(0,-1):t)||"/";if(!Le(t,!0))return t||"/";const[r,...n]=t.split("?");return(r.slice(0,-1)||"/")+(n.length?`?${n.join("?")}`:"")}function Qr(t="",e=!1){if(!e)return t.endsWith("/")?t:t+"/";if(Le(t,!0))return t||"/";const[r,...n]=t.split("?");return r+"/"+(n.length?`?${n.join("?")}`:"")}function Hr(t=""){return t.startsWith("/")}function Jr(t=""){return(Hr(t)?t.substr(1):t)||"/"}function zr(t,e){if(Zr(e)||lt(t))return t;const r=Wr(e);return t.startsWith(r)?t:tn(r,t)}function Xr(t,e){const r=rn(t),n=_(_({},Vr(r.search)),e);return r.search=Yr(n),nn(r)}function Zr(t){return!t||t==="/"}function en(t){return t&&t!=="/"}function tn(t,...e){let r=t||"";for(const n of e.filter(en))r=r?Qr(r)+Jr(n):n;return r}function rn(t="",e){if(!lt(t,!0))return ft(t);const[r="",n,s=""]=(t.replace(/\\/g,"/").match(/([^:/]+:)?\/\/([^/@]+@)?(.*)/)||[]).splice(1),[o="",a=""]=(s.match(/([^/?#]*)(.*)?/)||[]).splice(1),{pathname:u,search:d,hash:c}=ft(a);return{protocol:r,auth:n?n.substr(0,n.length-1):"",host:o,pathname:u,search:d,hash:c}}function ft(t=""){const[e="",r="",n=""]=(t.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:e,search:r,hash:n}}function nn(t){const e=t.pathname+(t.search?(t.search.startsWith("?")?"":"?")+t.search:"")+t.hash;return t.protocol?t.protocol+"//"+(t.auth?t.auth+"@":"")+t.host+e:e}class sn extends Error{constructor(){super(...arguments),this.name="FetchError"}}function on(t,e,r){let n="";t&&r&&(n=`${r.status} ${r.statusText} (${t.toString()})`),e&&(n=`${e.message} (${n})`);const s=new sn(n);return Object.defineProperty(s,"request",{get(){return t}}),Object.defineProperty(s,"response",{get(){return r}}),Object.defineProperty(s,"data",{get(){return r&&r._data}}),Object.defineProperty(s,"status",{get(){return r&&r.status}}),Object.defineProperty(s,"statusText",{get(){return r&&r.statusText}}),Object.defineProperty(s,"statusCode",{get(){return r&&r.status}}),Object.defineProperty(s,"statusMessage",{get(){return r&&r.statusText}}),s}const an=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function ht(t="GET"){return an.has(t.toUpperCase())}function cn(t){if(t===void 0)return!1;const e=typeof t;return e==="string"||e==="number"||e==="boolean"||e===null?!0:e!=="object"?!1:Array.isArray(t)?!0:t.constructor&&t.constructor.name==="Object"||typeof t.toJSON=="function"}const dn=new Set(["image/svg","application/xml","application/xhtml","application/html"]),un=/^application\/(?:[\w!#$%&*`\-.^~]*\+)?json(;.+)?$/i;function ln(t=""){if(!t)return"json";const e=t.split(";").shift();return un.test(e)?"json":dn.has(e)||e.startsWith("text/")?"text":"blob"}const fn=new Set([408,409,425,429,500,502,503,504]);function pt(t){const{fetch:e,Headers:r}=t;function n(a){const u=a.error&&a.error.name==="AbortError"||!1;if(a.options.retry!==!1&&!u){const c=typeof a.options.retry=="number"?a.options.retry:ht(a.options.method)?0:1,i=a.response&&a.response.status||500;if(c>0&&fn.has(i))return s(a.request,C(_({},a.options),{retry:c-1}))}const d=on(a.request,a.error,a.response);throw Error.captureStackTrace&&Error.captureStackTrace(d,s),d}const s=function(c){return T(this,arguments,function*(u,d={}){const i={request:u,options:_(_({},t.defaults),d),response:void 0,error:void 0};i.options.onRequest&&(yield i.options.onRequest(i)),typeof i.request=="string"&&(i.options.baseURL&&(i.request=zr(i.request,i.options.baseURL)),(i.options.query||i.options.params)&&(i.request=Xr(i.request,_(_({},i.options.params),i.options.query))),i.options.body&&ht(i.options.method)&&cn(i.options.body)&&(i.options.body=typeof i.options.body=="string"?i.options.body:JSON.stringify(i.options.body),i.options.headers=new r(i.options.headers),i.options.headers.has("content-type")||i.options.headers.set("content-type","application/json"),i.options.headers.has("accept")||i.options.headers.set("accept","application/json"))),i.response=yield e(i.request,i.options).catch(p=>T(this,null,function*(){return i.error=p,i.options.onRequestError&&(yield i.options.onRequestError(i)),n(i)}));const h=(i.options.parseResponse?"json":i.options.responseType)||ln(i.response.headers.get("content-type")||"");if(h==="json"){const p=yield i.response.text(),f=i.options.parseResponse||Rr;i.response._data=f(p)}else h==="stream"?i.response._data=i.response.body:i.response._data=yield i.response[h]();return i.options.onResponse&&(yield i.options.onResponse(i)),i.response.status>=400&&i.response.status<600?(i.options.onResponseError&&(yield i.options.onResponseError(i)),n(i)):i.response})},o=function(u,d){return s(u,d).then(c=>c._data)};return o.raw=s,o.create=(a={})=>pt(C(_({},t),{defaults:_(_({},t.defaults),a)})),o}const gt=function(){if(typeof globalThis!="undefined")return globalThis;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object")}(),hn=gt.fetch||(()=>Promise.reject(new Error("[ohmyfetch] global.fetch is not supported!"))),pn=gt.Headers,gn=pt({fetch:hn,Headers:pn});var q,mn=new Uint8Array(16);function _n(){if(!q&&(q=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!q))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return q(mn)}const yn=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function En(t){return typeof t=="string"&&yn.test(t)}for(var E=[],Ge=0;Ge<256;++Ge)E.push((Ge+256).toString(16).substr(1));function wn(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(E[t[e+0]]+E[t[e+1]]+E[t[e+2]]+E[t[e+3]]+"-"+E[t[e+4]]+E[t[e+5]]+"-"+E[t[e+6]]+E[t[e+7]]+"-"+E[t[e+8]]+E[t[e+9]]+"-"+E[t[e+10]]+E[t[e+11]]+E[t[e+12]]+E[t[e+13]]+E[t[e+14]]+E[t[e+15]]).toLowerCase();if(!En(r))throw TypeError("Stringified UUID is invalid");return r}function bn(t,e,r){t=t||{};var n=t.random||(t.rng||_n)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,wn(n)}var vn=Object.defineProperty,In=Object.defineProperties,Tn=Object.getOwnPropertyDescriptors,mt=Object.getOwnPropertySymbols,Pn=Object.prototype.hasOwnProperty,An=Object.prototype.propertyIsEnumerable,Ne=(t,e,r)=>e in t?vn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,De=(t,e)=>{for(var r in e||(e={}))Pn.call(e,r)&&Ne(t,r,e[r]);if(mt)for(var r of mt(e))An.call(e,r)&&Ne(t,r,e[r]);return t},_t=(t,e)=>In(t,Tn(e)),Rn=(t,e,r)=>(Ne(t,e+"",r),r),xn=(t,e,r)=>new Promise((n,s)=>{var o=d=>{try{u(r.next(d))}catch(c){s(c)}},a=d=>{try{u(r.throw(d))}catch(c){s(c)}},u=d=>d.done?n(d.value):Promise.resolve(d.value).then(o,a);u((r=r.apply(t,e)).next())}),V=()=>typeof window!="undefined";const yt="application/vnd.gyg.v2+json",Sn=2e3;var Un=(t,e,r)=>xn(void 0,null,function*(){if(V()&&navigator.sendBeacon){const u=new Blob([JSON.stringify(e)],{type:yt});return navigator.sendBeacon(t,u)}const n=typeof AbortController!="undefined"?new AbortController:void 0,s=setTimeout(()=>n==null?void 0:n.abort(),Sn),a=yield gn(t,{method:"POST",mode:"cors",cache:"no-cache",headers:De({"Content-Type":yt},r?{"x-request-id":r}:void 0),keepalive:!0,body:e,signal:n==null?void 0:n.signal});return clearTimeout(s),a});class On{constructor(e){Rn(this,"_config"),this._config=e}log(e,r){var n,s;return!r||!this._config?Promise.resolve():(r.producer_properties={common:this.autoPopulateCommonProperties((n=r.producer_properties)==null?void 0:n.common),web_frontend:this.autoPopulateWebFrontendProperties((s=r.producer_properties)==null?void 0:s.web_frontend)},this._config.isDebug&&console.log(`Would send this event to ${this.getEventUrl(e)}:`,r),Un(this.getEventUrl(e),r,this._config.xRequestId))}autoPopulateCommonProperties(e){var r,n;return _t(De({},e!=null?e:{}),{sent_by:(r=this._config.sentBy)!=null?r:"",timestamp:new Date().toISOString(),producer_id:bn(),tracking_method:"collector",application_version:(n=this._config.applicationVersion)!=null?n:""})}autoPopulateWebFrontendProperties(e){var r,n,s,o,a,u,d,c,i;return _t(De({},e!=null?e:{}),{platform:(r=this._config.platform)!=null?r:"",user_agent:V()?navigator.userAgent:(n=this._config.userAgent)!=null?n:"",view_id:(o=(s=this._config)==null?void 0:s.viewId)!=null?o:"",container_name:(u=(a=this._config)==null?void 0:a.containerName)!=null?u:"",visitor_id:this._config.visitorId,domain:V()?window.location.host:(d=this._config.domain)!=null?d:"",url:V()?window.location.href:(c=this._config.url)!=null?c:"",referrer_url:V()?document.referrer:(i=this._config.referrerUrl)!=null?i:""})}getEventUrl(e){return`${this._config.collectorUrl}/track/${e}`}}const Cn=(t,e,r)=>{try{const n={isDebug:!1,collectorUrl:t.collector_url,sentBy:t.sent_by,applicationVersion:t.version,platform:t.platform,viewId:t.view_id,containerName:t.container_name,userAgent:t.userAgent,domain:t.domain,url:t.url,referrerUrl:t.referrer_url,visitorId:t.visitor_id};new On(n).log(r,e)}catch(n){console.error("AEL ERROR",n)}};class S{constructor(e,r,n=m){this.dataRepository=e,this.document=r,this.baseUrl=n}sendEvent(e){window.fetch(this.collectorUrl,{method:"POST",headers:{"Content-type":"text/plain"},body:JSON.stringify(e),keepalive:!0})}sendEventV2(e,r){var s,o,a,u,d;const n={collector_url:this.baseUrl,version:this.dataRepository.version,platform:(s=this.dataRepository.header)==null?void 0:s.platform,view_id:"",container_name:this.dataRepository.container_name,userAgent:(o=this.dataRepository.header)==null?void 0:o.user_agent,domain:this.document.domain,url:this.document.URL,referrer_url:(a=this.dataRepository.header)==null?void 0:a.referrer_url,visitor_id:(u=this.dataRepository.user)==null?void 0:u.visitor_id,sent_by:(d=this.dataRepository.event_properties)==null?void 0:d.sent_by};Cn(n,e,r)}}const Ln="PartnerAnalyzerPageRequest";class Gn extends S{constructor(){super(...arguments),this._visitorId="",this._sessionId=""}get visitorId(){return this._visitorId}set visitorId(e){this._visitorId=e}get sessionId(){return this._sessionId}set sessionId(e){this._sessionId=e}get collectorUrl(){return this.baseUrl+"/track/PartnerAnalyzerPageRequest?format=json&strict=true"}cleanupDataRepository(){delete this.dataRepository.competitor_deeplinks,delete this.dataRepository.competitor_widgets,delete this.dataRepository.deeplinks,delete this.dataRepository.widgets}collectData(e){return T(this,null,function*(){yield Promise.all(wr.map(r=>new r().start({document:e,payload:this.dataRepository,visitorId:this.visitorId,sessionId:this.sessionId})))})}onNewPageEvent(){if(!this.dataRepository.user||!this.dataRepository.header){console.log("PA: Data hasn't been collected yet, skipping event");return}const e=this.getEventV2Payload();try{this.sendEventV2(e,Ln),this.cleanupDataRepository()}catch(r){console.error("PA ERROR",r)}}addEventListeners(){const e=n=>{window.addEventListener(n,this.onNewPageEvent.bind(this),{capture:!0})},r="onpagehide"in window?"pagehide":"unload";e(r),vr.isHistorySupported()&&e("changestate")}addPostMessageListener(){window.addEventListener("message",e=>{const{sessionId:r=null}=e.data;this.sessionId=r},{once:!0,passive:!0,capture:!0})}start(){this.addEventListeners(),this.addPostMessageListener(),setInterval(()=>{if(this.document.readyState==="complete")try{this.collectData(document)}catch(e){}},1e3)}getEventV2Payload(){const e=this.getWidgetsV2(),r=fe(this.dataRepository.header.url);return{customer_id:this.dataRepository.user.customer_id,partner_hash_code:this.dataRepository.header.partner_hash_code,partner_id:this.dataRepository.header.partner_id,page_id:r,page:this.dataRepository.page,widgets:e,deeplinks:this.dataRepository.deeplinks,competitor_widgets:this.dataRepository.competitor_widgets,competitor_deeplinks:this.dataRepository.competitor_deeplinks,version:this.dataRepository.version,script_origin:this.dataRepository.script_origin?this.dataRepository.script_origin.toString():""}}getWidgetV2Parameters(e){const r=e.widget_parameters&&this.getGeoLocationIfPresent(e.widget_parameters.geo_location),n=e.widget_parameters&&{widget_id:e.widget_parameters.widget_id,campaign:this.getParameterIfPresent(e.widget_parameters.campaign),currency:this.getParameterIfPresent(e.widget_parameters.currency),excluded_tour_ids:this.getParameterIfPresent(e.widget_parameters.excluded_tour_ids),iata:this.getParameterIfPresent(e.widget_parameters.iata),location_id:this.getParameterIfPresent(e.widget_parameters.location_id),locale_code:this.getParameterIfPresent(e.widget_parameters.locale_code),number_of_items:this.getParameterIfPresent(e.widget_parameters.number_of_items),partner_hash_code:this.getParameterIfPresent(e.widget_parameters.partner_hash_code),query:this.getParameterIfPresent(e.widget_parameters.query),version:this.getParameterIfPresent(e.widget_parameters.version),release_version:this.getParameterIfPresent(e.widget_parameters.release_version),format:this.getParameterIfPresent(e.widget_parameters.format),tour_ids:this.getParameterIfPresent(e.widget_parameters.tour_ids)};return r&&(n.geo_location=r),n}getGeoLocationIfPresent(e){if(e&&e.latitude&&e.longitude)return{latitude:e.latitude,longitude:e.longitude}}getParameterIfPresent(e){return e||void 0}getWidgetsV2(){const e=new Array;return this.dataRepository.widgets&&this.dataRepository.widgets.forEach(r=>{const s={widget_parameters:this.getWidgetV2Parameters(r),x:r.x,y:r.y,width:r.width,height:r.height,type:r.type,rendering_time:r.rendering_time,fcp:r.fcp,ttfb:r.ttfb,lcp:r.lcp};e.push(s)}),e}}const Nn="PartnerDeeplinkClick",ae=class ae extends S{get collectorUrl(){return this.baseUrl+"/track/PartnerDeeplinkClick?format=json&strict=true"}getAllGYGDeeplinks(){return this.document.querySelectorAll('a[href*="getyourguide."]')}handleOnClick(e){const r=this.getEventV2Payload(e);try{this.sendEventV2(r,Nn)}catch(n){console.error("PDCE ERROR",n)}}getEventV2Payload(e){const r=this.getHREFFromEvent(e),n=fe(this.dataRepository.header.url);return{customer_id:this.dataRepository.user.customer_id,partner_hash_code:this.dataRepository.header.partner_hash_code,partner_id:this.dataRepository.header.partner_id,page_id:n,page:this.dataRepository.page,deeplink_url:r,deeplink_id:F(r,ae.NAMESPACE)}}getHREFFromEvent(e){const r=e.target;return k(r.href)}trackDeeplink(e,r){e.target="_blank",e.addEventListener("click",r)}start(){this.getAllGYGDeeplinks().forEach(e=>this.trackDeeplink(e,this.handleOnClick.bind(this)))}};ae.NAMESPACE="6ba7b811-9dad-11d1-80b4-00c04fd430c8";let Be=ae;var Dn=function(e){return Bn(e)&&!jn(e)};function Bn(t){return!!t&&typeof t=="object"}function jn(t){var e=Object.prototype.toString.call(t);return e==="[object RegExp]"||e==="[object Date]"||Vn(t)}var kn=typeof Symbol=="function"&&Symbol.for,Mn=kn?Symbol.for("react.element"):60103;function Vn(t){return t.$$typeof===Mn}function $n(t){return Array.isArray(t)?[]:{}}function $(t,e){return e.clone!==!1&&e.isMergeableObject(t)?G($n(t),t,e):t}function Yn(t,e,r){return t.concat(e).map(function(n){return $(n,r)})}function Fn(t,e){if(!e.customMerge)return G;var r=e.customMerge(t);return typeof r=="function"?r:G}function Kn(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[]}function Et(t){return Object.keys(t).concat(Kn(t))}function wt(t,e){try{return e in t}catch(r){return!1}}function qn(t,e){return wt(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))}function Wn(t,e,r){var n={};return r.isMergeableObject(t)&&Et(t).forEach(function(s){n[s]=$(t[s],r)}),Et(e).forEach(function(s){qn(t,s)||(wt(t,s)&&r.isMergeableObject(e[s])?n[s]=Fn(s,r)(t[s],e[s],r):n[s]=$(e[s],r))}),n}function G(t,e,r){r=r||{},r.arrayMerge=r.arrayMerge||Yn,r.isMergeableObject=r.isMergeableObject||Dn,r.cloneUnlessOtherwiseSpecified=$;var n=Array.isArray(e),s=Array.isArray(t),o=n===s;return o?n?r.arrayMerge(t,e,r):Wn(t,e,r):$(e,r)}G.all=function(e,r){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(n,s){return G(n,s,r)},{})};var Qn=G,Hn=Qn;const Jn=at(Hn);class je{constructor(e,r,n=m){this.dataRepository=e,this.document=r,this.baseUrl=n}sendEvent(e,r){const n=Jn(this.getUIEventBase(),r);n&&n.event_properties&&(n.event_properties.event_name=e),n&&n.metadata&&(n.metadata=JSON.stringify(n.metadata)),window.fetch(this.collectorUrl,{method:"POST",headers:{"Content-type":"text/plain"},body:JSON.stringify(n),keepalive:!0})}getUIEventBase(){return{event_properties:_({},this.dataRepository.event_properties),container_name:this.dataRepository.container_name,user:this.dataRepository.user,header:_({},this.dataRepository.header)}}}function x(t,e){window.addEventListener("message",r=>{const n=r==null?void 0:r.data;try{if(n&&n.messageType==="event_logger"){const{eventType:s}=n;if(!s||s.toLowerCase()!==t.toLowerCase())return;e(n)}}catch(s){console.error(`Failed to send ${t} with Partner Analyzer`)}})}class zn extends je{constructor(){super(...arguments),this.eventType="UIClick"}get collectorUrl(){return this.baseUrl+`/track/${this.eventType}?format=json&strict=true`}sendEventCallback(e){this.sendEvent(e.eventType,e.eventData)}start(){x(this.eventType,this.sendEventCallback.bind(this))}}class Xn extends je{constructor(){super(...arguments),this.eventType="UIShow"}get collectorUrl(){return this.baseUrl+`/track/${this.eventType}?format=json&strict=true`}sendEventCallback(e){this.sendEvent(e.eventType,e.eventData)}start(){x(this.eventType,this.sendEventCallback.bind(this))}}class Zn extends je{constructor(){super(...arguments),this.eventType="UIEnteredDisplayPort"}get collectorUrl(){return this.baseUrl+`/track/${this.eventType}?format=json&strict=true`}sendEventCallback(e){this.sendEvent(e.eventType,e.eventData)}start(){x(this.eventType,this.sendEventCallback.bind(this))}}const bt="TicketingWebUIClick",Ke=class Ke extends S{get collectorUrl(){return""}sendEventCallback(e){this.sendEventV2(e.eventData,bt)}start(){x(bt,this.sendEventCallback.bind(this))}};Ke.NAMESPACE="7cde4402-cd54-4f28-a4aa-5eb96add2d88";let ke=Ke;const vt="TicketingWebPageView",qe=class qe extends S{get collectorUrl(){return""}sendEventCallback(e){this.sendEventV2(e.eventData,vt)}start(){x(vt,this.sendEventCallback.bind(this))}};qe.NAMESPACE="7dde5df8-7dba-4469-ba5a-a800de137523";let Me=qe;const It="TicketingWebLinkVisible",We=class We extends S{get collectorUrl(){return""}sendEventCallback(e){this.sendEventV2(e.eventData,It)}start(){x(It,this.sendEventCallback.bind(this))}};We.NAMESPACE="1ac966b7-eba7-4c83-b142-e738da02bf30";let Ve=We;const Tt="TicketingWebInitialized",Qe=class Qe extends S{get collectorUrl(){return""}sendEventCallback(e){this.sendEventV2(e.eventData,Tt)}start(){x(Tt,this.sendEventCallback.bind(this))}};Qe.NAMESPACE="cc34b8d9-1676-433b-8785-17712b04b97b";let $e=Qe;const Pt="TicketingWebAddToCartSuccess",He=class He extends S{get collectorUrl(){return""}sendEventCallback(e){this.sendEventV2(e.eventData,Pt)}start(){x(Pt,this.sendEventCallback.bind(this))}};He.NAMESPACE="c9a6bfce-16d7-452e-b463-2872065684c3";let Ye=He;const At="TicketingWebNoAvailability",Je=class Je extends S{get collectorUrl(){return""}sendEventCallback(e){this.sendEventV2(e.eventData,At)}start(){x(At,this.sendEventCallback.bind(this))}};Je.NAMESPACE="67e16cd6-4425-4b51-b1e3-beec495401d1";let Fe=Je;const es=[Gn,Be,zn,Xn,Zn,ke,Me,Ve,$e,Ye,Fe];class ts{constructor(){this.dataRepository={container_name:"partner-analyzer",version:"e8c55ceea76d316f7c4008814a55a7a9a32eddcf"},window._GYG=window._GYG||{};const e="pa_debug",n=new URL(window.location.href).searchParams.get(e);n==="1"?K(e,n):n==="0"&&Vt(e),window._GYG.debug=tt(e)==="1",es.forEach(s=>{new s(this.dataRepository,document).start()})}}function rs(){new ts}(function(){if(!window.gygPAStatus){if(window.gygPAStatus="loading",window._GYG=window._GYG||{},window._GYG.env="production",window._GYG.loadOnlyPA!==!0){window._GYG.env==="test"&&console.log("Loading widget script");const t=`${D}/pw/latest/client-loader/widget.js`;document.querySelector(`script[src="${t}"]`)||R(t)}de(document.URL)&&(window.gygPAStatus="ok",rs())}})()});
